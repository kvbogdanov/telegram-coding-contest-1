"use strict";function Graph(a,b,c=!1){const d=10,f=0,g=1,h=2;var k={id:a,uid:Math.random().toString(16).slice(2),sourceData:b,normalizedData:[],container:null,graph:null,navigation:null,viewport:null,preViewport:null,postViewport:null,legend:null,hiddenLines:[],navigationStart:.699,navigationWidth:.3,viewTop:1,currentTopY:0,viewBottom:0,labels:[],zeroBased:c},l={init:function(){if(k.container=document.getElementById(k.id),k.graph=k.container.appendChild(document.createElement("div")),k.graph.style.height=1<Object.keys(k.sourceData.names).length?"80%":"90%",k.navigation=k.container.appendChild(document.createElement("div")),k.navigation.style.height="10%",k.preViewport=k.navigation.appendChild(document.createElement("div")),k.preViewport.style.backgroundColor="#eee",k.preViewport.style.opacity="0.7",k.preViewport.style.position="absolute",k.viewport=k.navigation.appendChild(document.createElement("div")),k.viewport.style.border="2px solid #ddd",k.viewport.style.position="absolute",k.viewport.style.zIndex=1e3,k.viewport.setAttributeNS(null,"class","viewport"),k.postViewport=k.navigation.appendChild(document.createElement("div")),k.postViewport.style.backgroundColor="#eee",k.postViewport.style.opacity="0.7",k.postViewport.style.position="absolute",1<Object.keys(k.sourceData.names).length){k.legend=k.container.appendChild(document.createElement("div")),k.legend.style.height="10%";var a=0;for(var b in k.sourceData.names){if(k.sourceData.names.hasOwnProperty(b)){function c(a){let b=document.getElementById(a.srcElement.getAttribute("data-line"));if("undefined"!=typeof b){let d=parseInt(a.srcElement.getAttribute("data-line").split("_")[2]);if(k.hiddenLines.includes(d)){a.srcElement.getElementsByTagName("div")[0].style.backgroundColor=a.srcElement.style.color;var c=k.hiddenLines.indexOf(d);-1<c&&k.hiddenLines.splice(c,1),l.setViewtop(),l.redraw(!0),l.animate({duration:500,timing:function(a){return a},draw:function(a){b.style.opacity=a}})}else{if(k.hiddenLines.length+1==k.normalizedData.y.length)return;a.srcElement.getElementsByTagName("div")[0].style.backgroundColor="white",k.hiddenLines.push(d),l.setViewtop(),l.redraw(!0),l.animate({duration:500,timing:function(a){return a},draw:function(a){b.style.opacity=1-a}})}}}let d=k.legend.appendChild(document.createElement("div")),e=document.createTextNode(k.sourceData.names[b]),f=d.appendChild(document.createElement("div")),g=document.createTextNode("\u2713");d.setAttributeNS(null,"class","toggle-btn"),d.setAttributeNS(null,"data-color",k.sourceData.colors[b]),d.setAttributeNS(null,"data-line","gline_"+k.uid+"_"+a),d.style.color=k.sourceData.colors[b],f.setAttributeNS(null,"class","toggle-btn-icon"),f.style.textAlign="center",f.style.borderColor=k.sourceData.colors[b],f.style.backgroundColor=k.sourceData.colors[b],f.appendChild(g),d.appendChild(f),d.appendChild(e),d.onclick=function(a){c(a)}}a++}}},normalize:function(){let a=[],b=[],c=0,d=1/0,e=0,f=0,g=0,h=0;for(var i=0;i<k.sourceData.columns.length;i++)if("x"==k.sourceData.columns[i][0])a=k.sourceData.columns[i].slice(1);else{let a=parseInt(k.sourceData.columns[i][0][1]);b[a]=k.sourceData.columns[i].slice(1),c<Math.max.apply(null,b[a])&&(c=Math.max.apply(null,b[a])),d>Math.min.apply(null,b[a])&&(d=Math.min.apply(null,b[a]))}e=100/Math.abs(Math.max.apply(null,a)-Math.min.apply(null,a)),f=1*Math.min.apply(null,a),g=100/Math.abs(c-d),h=1*d-2,k.normalizedData={x:a,y:b,deltaX:e,shiftX:f,deltaY:g,shiftY:h,maxY:c,minY:d}},setViewtop:function(){let a=k.normalizedData,b=0,c=0;for(var d=0;d<=a.x.length-1;d++){let f=(a.x[d]-a.shiftX)*a.deltaX;if(!(f<100*k.navigationStart||f>100*(k.navigationStart+k.navigationWidth)))for(var e=0;e<=a.y.length-1;e++)k.hiddenLines.includes(e)||(a.y[e][d]-a.shiftY)*a.deltaY>b&&(b=(a.y[e][d]-a.shiftY)*a.deltaY,c=a.y[e][d])}return k.currentTopY=c,k.viewTop=b/101,b},animate:function(a){var b=performance.now();requestAnimationFrame(function c(d){var e=(d-b)/a.duration;1<e&&(e=1);var f=a.timing(e);0>f&&(f=0),a.draw(f),1>e&&requestAnimationFrame(c)})},redraw:function(a){if(!a){let a=Math.ceil(100-100*k.viewTop);document.getElementById("mainGraph_"+k.uid).setAttribute("viewBox",parseFloat(100*k.navigationStart)+" "+a+" "+parseFloat(100*k.navigationWidth)+" "+(102-a))}else{var b=document.getElementById("mainGraph_"+k.uid).getAttribute("viewBox").split(" ");l.animate({duration:500,timing:function(a){return a},draw:function(a){let c=100*(1-k.viewTop-k.viewBottom),d=parseFloat(b[1]),e=parseFloat(b[3]);d-=(d-c)*a,e-=(e-102+c)*a,document.getElementById("mainGraph_"+k.uid).setAttribute("viewBox",parseFloat(100*k.navigationStart)+" "+d+" "+parseFloat(100*k.navigationWidth)+" "+e)}})}l.drawGuidelines()},navdecor:function(){k.preViewport.style.height=k.navigation.offsetHeight+"px",k.preViewport.style.left=parseFloat(k.navigation.getBoundingClientRect().left)+"px",k.preViewport.style.width=parseFloat(k.viewport.style.left)-parseFloat(k.navigation.getBoundingClientRect().left)+"px",k.postViewport.style.height=k.navigation.offsetHeight+"px",k.postViewport.style.left=parseFloat(k.viewport.style.left)+parseFloat(k.viewport.style.width)+4+"px",k.postViewport.style.width=parseFloat(k.navigation.getBoundingClientRect().right)-parseFloat(k.postViewport.style.left)+"px"},draw:function(){function a(a,b,c,d){let e=document.createElementNS("http://www.w3.org/2000/svg","polyline"),f="";!d&&k.zeroBased&&(a.shiftY=0);for(var g=0;g<=a.x.length-1;g++)f+=(a.x[g]-a.shiftX)*a.deltaX+" "+(101-(a.y[b][g]-a.shiftY)*a.deltaY)+" ";return e.setAttributeNS(null,"points",f),e.setAttributeNS(null,"id","gline_"+k.uid+"_"+b),e.setAttributeNS(null,"stroke",c),e.setAttributeNS(null,"fill","none"),e.setAttributeNS(null,"stroke-width","1.5"),e.setAttributeNS(null,"vector-effect","non-scaling-stroke"),e.setAttributeNS(null,"shape-rendering","geometricPrecision"),e}function b(a){let b=a.touches[0],c=a.target.getBoundingClientRect();return b.offsetX=a.targetTouches[0].pageX-c.left,b}function c(a){function c(a){let b=k.viewport.style.left,c=k.viewport.style.width;q==g?parseFloat(a.pageX-n)>k.navigation.getBoundingClientRect().x&&parseFloat(a.pageX-n)+k.viewport.getBoundingClientRect().width<k.navigation.getBoundingClientRect().right?(k.viewport.style.left=a.pageX-n+"px",k.navigationStart=(k.viewport.getBoundingClientRect().x-k.navigation.getBoundingClientRect().x)/k.navigation.getBoundingClientRect().width):parseFloat(a.pageX-n)<=k.navigation.getBoundingClientRect().x?(k.viewport.style.left=k.navigation.getBoundingClientRect().x+"px",k.navigationStart=0):(k.viewport.style.left=k.navigation.getBoundingClientRect().right-k.viewport.getBoundingClientRect().width+"px",k.navigationStart=1-k.navigationWidth):q==f?parseFloat(a.pageX-n)>k.navigation.getBoundingClientRect().x&&parseFloat(a.pageX-n)<k.viewport.getBoundingClientRect().right-20?(k.viewport.style.left=a.pageX-n+"px",k.navigationStart=(k.viewport.getBoundingClientRect().x-k.navigation.getBoundingClientRect().x)/k.navigation.getBoundingClientRect().width,k.navigationWidth+=(parseFloat(b)-parseFloat(k.viewport.style.left))/k.navigation.getBoundingClientRect().width,k.viewport.style.width=k.navigation.offsetWidth*k.navigationWidth+"px"):parseFloat(a.pageX-n)<=k.navigation.getBoundingClientRect().x&&(k.viewport.style.left=k.navigation.getBoundingClientRect().x+"px",k.navigationStart=0,k.navigationWidth+=(parseFloat(b)-parseFloat(k.viewport.style.left))/k.navigation.getBoundingClientRect().width,k.viewport.style.width=k.navigation.offsetWidth*k.navigationWidth+"px"):q==h&&(20<parseFloat(k.viewport.style.width)&&parseFloat(k.viewport.style.left)+k.viewport.getBoundingClientRect().width<k.navigation.getBoundingClientRect().right?(k.viewport.style.width=parseFloat(k.viewport.style.left)+(a.pageX+p)-parseFloat(k.viewport.style.left)<k.navigation.getBoundingClientRect().right?a.pageX+p-parseFloat(k.viewport.style.left)+"px":k.navigation.getBoundingClientRect().width-parseFloat(k.viewport.style.left)+"px",k.navigationWidth=k.viewport.getBoundingClientRect().width/k.navigation.getBoundingClientRect().width):parseFloat(k.viewport.style.left)+k.viewport.getBoundingClientRect().width>=k.navigation.getBoundingClientRect().right?(k.viewport.style.width=parseFloat(k.viewport.style.left)+(a.pageX+p)-parseFloat(k.viewport.style.left)>=k.navigation.getBoundingClientRect().right?parseFloat(k.navigation.style.width)-parseFloat(k.viewport.style.left)+"px":a.pageX+p-parseFloat(k.viewport.style.left)+"px",k.navigationWidth=1-k.navigationStart):(k.viewport.style.width=20<=parseFloat(a.pageX+p-parseFloat(k.viewport.style.left))?a.pageX+p-parseFloat(k.viewport.style.left)+"px":"20px",k.navigationWidth=k.viewport.getBoundingClientRect().width/k.navigation.getBoundingClientRect().width)),l.navdecor(),l.redraw(!1)}function e(a){c(b(a))}function i(){document.onmousemove=null,document.onmouseup=null,k.viewport.onmouseup=null,document.removeEventListener("touchmove",e),document.removeEventListener("touchend",i),l.setViewtop(),l.redraw(!0)}var m=j(k.viewport),n=a.pageX-m.left,o=a.pageY-m.top,p=a.pageX-(m.left+parseFloat(k.viewport.style.width)),q=g;a.offsetX<d?q=f:a.offsetX>k.viewport.getBoundingClientRect().width-d&&(q=h),c(a),document.onmousemove=function(a){c(a)},document.addEventListener("touchmove",e),document.onmouseup=function(a){i(a)},document.addEventListener("touchend",i)}function j(a){var b=a.getBoundingClientRect();return{top:b.top+pageYOffset,left:b.left+pageXOffset}}function m(a){let b=q.getElementById("probe_"+k.uid);if(b){b.parentNode.removeChild(b);let a=q.getElementsByTagName("ellipse");for(var d=a.length-1;0<=d;d--)a[d].parentNode.removeChild(a[d]);(a=>a.forEach(a=>a.remove()))(k.graph.querySelectorAll(".infobox"))}let c=document.createElementNS("http://www.w3.org/2000/svg","line"),e=100*(a.offsetX/k.graph.getBoundingClientRect().width*k.navigationWidth+k.navigationStart),f=0,g=0;f=k.normalizedData.x.reduce(function(a,b){let c=function(a){return a/k.normalizedData.deltaX+k.normalizedData.shiftX}(e);return Math.abs(b-c)<Math.abs(a-c)?b:a}),g=k.normalizedData.x.indexOf(f),e=(f-k.normalizedData.shiftX)*k.normalizedData.deltaX;let h=document.createElement("div"),j=new Date(f).toString().split(" "),l=document.createElement("div"),m=document.createElement("div"),n=document.createTextNode(j[0]+", "+j[1]+" "+j[2]),o=[];l.appendChild(n),h.appendChild(l);let p=window.getComputedStyle(document.body,null).getPropertyValue("background-color");"rgba(0, 0, 0, 0)"==p&&(p="#fff");for(var d=0;d<k.normalizedData.y.length;d++){if(k.hiddenLines.includes(d))continue;o[d]=document.createElement("div"),o[d].style.color=k.sourceData.colors["y"+d],o[d].style.width=100/(k.normalizedData.y.length-k.hiddenLines.length)+"%",o[d].style.padding="10px 10px 10px 0";let a=document.createElement("span");a.appendChild(document.createTextNode(k.normalizedData.y[d][g])),o[d].appendChild(a),o[d].appendChild(document.createElement("br")),o[d].appendChild(document.createTextNode(k.sourceData.names["y"+d])),m.appendChild(o[d]);let b=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),c=100/k.graph.getBoundingClientRect().width*k.navigationWidth,f=100/k.graph.getBoundingClientRect().height*(k.viewTop-k.viewBottom);b.setAttributeNS(null,"cx",e),b.setAttributeNS(null,"cy",101-(k.normalizedData.y[d][g]-k.normalizedData.shiftY)*k.normalizedData.deltaY),b.setAttributeNS(null,"rx",4*c),b.setAttributeNS(null,"ry",4*f),b.setAttributeNS(null,"fill",p),b.setAttributeNS(null,"stroke",k.sourceData.colors["y"+d]),b.setAttributeNS(null,"stroke-width",2),b.setAttributeNS(null,"vector-effect","non-scaling-stroke"),q.appendChild(b)}m.style.display="flex",h.appendChild(m),c.setAttributeNS(null,"x1",e),c.setAttributeNS(null,"y1","0"),c.setAttributeNS(null,"x2",e),c.setAttributeNS(null,"y2","101"),c.setAttributeNS(null,"id","probe_"+k.uid),c.setAttributeNS(null,"stroke","#ccc"),c.setAttributeNS(null,"stroke-width",.5),c.setAttributeNS(null,"vector-effect","non-scaling-stroke"),q.appendChild(c),h.className="infobox",h.style.top=k.graph.offsetTop+10+"px",h.style.backgroundColor=p,"#fff"!=p&&(h.style.color="#eee"),k.graph.appendChild(h),h.style.left=a.pageX-h.getBoundingClientRect().width/3+"px",h.getBoundingClientRect().right>k.graph.getBoundingClientRect().right&&(h.style.left=parseInt(h.style.left)-parseInt(h.getBoundingClientRect().right-k.graph.getBoundingClientRect().right-0*h.getBoundingClientRect().width)+"px"),h.getBoundingClientRect().left<k.graph.getBoundingClientRect().left&&(h.style.left=parseInt(h.style.left)+parseInt(k.graph.getBoundingClientRect().left-h.getBoundingClientRect().left+0*h.getBoundingClientRect().width)+"px")}var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"preserveAspectRatio","none"),n.setAttributeNS(null,"viewBox","0 0 100 100"),k.navigation.appendChild(n);for(var o=[],p=0;p<k.normalizedData.y.length;p++)o.push(a(k.normalizedData,p,k.sourceData.colors["y"+p],!0)),n.appendChild(o[p]);var q=document.createElementNS("http://www.w3.org/2000/svg","svg");q.setAttributeNS(null,"preserveAspectRatio","none"),q.setAttributeNS(null,"id","mainGraph_"+k.uid),q.setAttributeNS(null,"viewBox",parseFloat(100*k.navigationStart)+" 0 "+parseFloat(100*k.navigationWidth)+" 100"),k.graph.appendChild(q);for(var r=[],p=0;p<k.normalizedData.y.length;p++)r.push(a(k.normalizedData,p,k.sourceData.colors["y"+p],!1)),q.appendChild(r[p]);q.setAttributeNS(null,"height",k.graph.offsetHeight),q.setAttributeNS(null,"width",k.graph.offsetWidth),n.setAttributeNS(null,"height",k.navigation.offsetHeight),n.setAttributeNS(null,"width",k.navigation.offsetWidth),k.viewport.style.height=k.navigation.offsetHeight-4+"px",k.viewport.style.width=k.navigation.offsetWidth*k.navigationWidth+"px",k.viewport.style.left=k.navigation.getBoundingClientRect().x+k.navigation.offsetWidth*k.navigationStart+"px",k.viewport.style.cursor="pointer",l.navdecor(),k.viewport.ontouchstart=function(a){c(b(a))},k.viewport.onmousedown=function(a){c(a)},k.viewport.ondragstart=function(){return!1},q.style.position="relative",q.addEventListener("click",m)},drawGuidelines:function(){function a(a,b){let c=document.createElementNS("http://www.w3.org/2000/svg","line");return c.setAttributeNS(null,"x1","0"),c.setAttributeNS(null,"y1",a),c.setAttributeNS(null,"x2","100"),c.setAttributeNS(null,"y2",a),c.setAttributeNS(null,"id","hline_"+k.uid+"_"+b),c.setAttributeNS(null,"stroke","#ccc"),c.setAttributeNS(null,"stroke-width",.5),c.setAttributeNS(null,"vector-effect","non-scaling-stroke"),c}function b(a,b){let c=document.createElementNS("http://www.w3.org/2000/svg","text"),d=document.createTextNode(b),e=100/k.graph.getBoundingClientRect().width*k.navigationWidth,f=100/k.graph.getBoundingClientRect().height*(k.viewTop-k.viewBottom);return c.setAttributeNS(null,"x",parseFloat(100*k.navigationStart/e)),c.setAttributeNS(null,"y",a/f-8),c.setAttributeNS(null,"transform","scale("+e+" "+f+")"),c.setAttributeNS(null,"color","#ccc"),c.appendChild(d),c}function c(a,b){let c=document.createElementNS("http://www.w3.org/2000/svg","text"),d=document.createTextNode(b),e=100/k.graph.getBoundingClientRect().width*k.navigationWidth,f=100/k.graph.getBoundingClientRect().height*(k.viewTop-k.viewBottom);return a?a+=.2:a=.2,c.setAttributeNS(null,"x",a/e),c.setAttributeNS(null,"y",101/f-8),c.setAttributeNS(null,"transform","scale("+e+" "+f+")"),c.setAttributeNS(null,"color","#ccc"),c.appendChild(d),c}let d=document.getElementById("mainGraph_"+k.uid),e=d.getElementsByTagName("line"),f=d.getElementsByTagName("text"),g=d.getElementsByTagName("ellipse"),h=100*k.viewTop,j=100*k.viewBottom,l=100*k.navigationStart,m=100*(k.navigationStart+k.navigationWidth),n=parseInt(20*k.navigationWidth),o=0;for(var p=e.length-1;0<=p;p--)e[p].parentNode.removeChild(e[p]);for(var p=f.length-1;0<=p;p--)f[p].parentNode.removeChild(f[p]);for(var p=g.length-1;0<=p;p--)g[p].parentNode.removeChild(g[p]);(a=>a.forEach(a=>a.remove()))(k.graph.querySelectorAll(".infobox"));for(var p=0;p<h-1;p+=(h-j)/6){d.appendChild(a(101-p,o++));let c=b(101-p,parseInt(p/h*(k.currentTopY-k.normalizedData.shiftY)+k.normalizedData.shiftY));d.appendChild(c)}for(var p=1;100>p;p+=n){let a=parseInt((k.sourceData.columns[0].length-1)*p/100),b=new Date(k.sourceData.columns[0][a]).toString().split(" "),e=b[1]+" "+b[2],f=c(p-1,e);1==p||"Invalid Date"==e||d.appendChild(f)}}};return l.init(),l.normalize(),l.draw(),l.setViewtop(),l.redraw(!1),this}